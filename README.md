# Мини-система сбора и анализа данных

## Назначение

Проект представляет собой полноценную систему для генерации, хранения и анализа временных данных, имитирующих показания фитнес-трекеров группы пользователей. Целью разработки является демонстрация реализации сквозного (end-to-end) data pipeline, включающего компоненты генерации, хранения, визуализации и анализа данных.

Система предназначена для использования в учебных целях и может служить основой для изучения принципов работы с потоковыми данными, инструментами визуализации и средствами аналитики.

---

## Архитектура системы

Проект построен на микросервисной архитектуре с использованием Docker для оркестрации контейнеров. Все компоненты взаимодействуют между собой через локальную сеть, организованную с помощью `docker-compose`.

### 1. Генератор данных (Python)

Генератор реализован как отдельный сервис на языке Python. Основные характеристики:

- **Частота генерации**: одна запись на каждого пользователя каждые 5 секунд.
- **Количество пользователей**: 10, каждый с уникальным идентификатором (`user_id`).
- **Показатели**:
  - Количество шагов
  - Частота сердечных сокращений (пульс)
  - Расход калорий (рассчитывается на основе активности и пульса)
  - Тип активности: `walking`, `running`, `resting`
- **Реалистичность поведения**:
  - Активность сохраняется минимум 10 секунд.
  - С вероятностью 3% после истечения минимального времени происходит изменение активности.
  - Параметры шагов и пульса соответствуют физически возможным значениям для каждой активности.
- **Автоматизация**: сервис запускается автоматически при старте системы через Docker Compose.

### 2. База данных: PostgreSQL

Для хранения данных используется реляционная СУБД PostgreSQL. Данные всех пользователей сохраняются в единой таблице.

#### Структура таблицы `fitness_data`

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | `SERIAL PRIMARY KEY` | Уникальный идентификатор записи |
| `timestamp` | `TIMESTAMP DEFAULT NOW()` | Время фиксации показаний |
| `user_id` | `INTEGER` | Идентификатор пользователя (1–10) |
| `steps` | `INTEGER` | Количество шагов за интервал |
| `heart_rate` | `INTEGER` | Частота сердечных сокращений (ударов в минуту) |
| `calories` | `DECIMAL(5,2)` | Расход калорий за интервал |
| `activity_type` | `VARCHAR(50)` | Тип активности |

Таблица создается автоматически при первом запуске с помощью SQL-скрипта `init.sql`.

### 3. Визуализация: Redash

Для визуализации данных используется платформа Redash. Она предоставляет веб-интерфейс для создания запросов к базе данных, построения графиков и объединения их в дашборды.

#### Дашборд: «Fitness Analytics Dashboard»

Дашборд содержит следующие элементы:

1. **Сводная таблица пользователей**  
   Отображает средние значения пульса, шагов и калорий по каждому пользователю, а также общее количество записей и типы активностей.

2. **Распределение активностей по пользователям**  
   Столбчатая диаграмма, показывающая, какую долю времени каждый пользователь проводит в режимах ходьбы, бега или отдыха.

3. **Пульс по времени (по пользователям)**  
   Линейный график, позволяющий отслеживать динамику изменения пульса для каждого пользователя.

4. **Общее количество шагов в минуту**  
   Гистограмма, отражающая суммарную активность всех пользователей по минутам.

Адрес веб-интерфейса: [http://localhost:5000](http://localhost:5000)

> Для входа в систему используются тестовые учетные данные:  
> **Email:** `admin@example.com`  
> **Пароль:** `admin`

### 4. Анализ данных: Jupyter Notebook

Дополнительно к визуализации в Redash, в проекте представлен файл `notebooks/analysis.ipynb` — Jupyter Notebook, содержащий исследовательский анализ данных.

#### Функционал блокнота:
- Подключение к базе данных PostgreSQL через SQLAlchemy.
- Загрузка и предварительная обработка данных с использованием библиотек `pandas` и `numpy`.
- Построение графиков с помощью `matplotlib`:
  - Динамика пульса по времени для всех пользователей.
  - Распределение активностей.
  - Сравнение пользователей по средним метрикам.
- Интерпретация результатов и выводы.

---

## Инструкция по развёртыванию

### Предварительные требования

Перед началом работы необходимо установить следующее программное обеспечение:

- [Docker Desktop](https://www.docker.com/products/docker-desktop/) — для оркестрации контейнеров
- Git — для клонирования репозитория (опционально)

### Шаги по запуску

1. **Клонирование репозитория**

```bash
git clone https://github.com/PeroronShine/data-system.git
cd data-system
```

2. **Запуск системы**

В корневой директории проекта выполните команду:

```bash
docker-compose up --build
```

> Первый запуск может занять несколько минут, так как будут загружены образы, созданы тома и проинициализированы базы данных.

3. **Доступ к интерфейсам**

- **Redash**: откройте в браузере [http://localhost:5000](http://localhost:5000)
- **Jupyter Notebook** (если требуется локальный запуск):
  ```bash
  cd notebooks
  python -m notebook
  ```

4. **Остановка системы**

Для завершения работы нажмите `Ctrl + C` в терминале. Чтобы полностью очистить данные (включая историю), выполните:

```bash
docker-compose down --volumes
```
